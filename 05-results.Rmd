# Results
```{r setup, include=FALSE}
knitr::opts_chunk$set(warning = FALSE, message = FALSE, fig.width = 9)
```

```{r libraries}
library(foreign)
library(mi)
library(ggplot2)
library(extracat)
library(tidyverse)
library(RColorBrewer)
library(vcd)
```

```{r read file}
politics <- read.spss("../5702Final-Project/Jan20-public/Jan20 public.sav", to.data.frame = TRUE)
```

In this chapter, we are going to present our answers to each of the questions we proposed in the introduction section and also our process to come up with the answers and our conclusions. 

## Opinions of people identified with different parties on different matters

As we mentioned earlier in the introduction and data chapter, this January 2020 Political Survey conducted by Pew Research Center primarily surveys American people with a set of comprehensive political questions that encompass multiple aspects of the American politics. The first question is mainly about opinions of respondents identified with different political parties, and we hope to find out the primary political interests of each party and how their opinions compare on different political-relevant matters. This section would go over multiple social and political topics that were asked for respondents' opinions. 

### *Conflicts between different social groups in America*

For this topic, we choose the variables that document the political party the respondent identifies with and the respondent's opinion on how they view the level of conflicts between the following opposing groups: i) Poor people and rich people ii) Black people and white people iii) People who live in cities and people who live in rural areas iv) Young people and older people v) Democrats and Republicans. 

We'll use faceted bar chart to visualize the findings for this matter. In addition, for the cleanness of our analysis and visualization, we removed people who were not clear about their party identification (refused or not sure) and who did not respond with a clear answer on the level of conflicts they perceive between each opposing social group (refused/Can't choose).


```{r select q10 and PARTY}
conflicts <- politics[,c("party","q10a","q10b","q10c","q10d","q10e")]
colnames(conflicts) <- c("Party", 
                         "Poor and Rich", 
                         "Black and White", 
                         "People in Cities and in Rural Areas", 
                         "Young and Old", 
                         "Democrats and Republicans")
conflicts_tidy <- pivot_longer(conflicts, !Party, 
                               names_to = "Question", 
                               values_to = "Response")
conflicts_tidy <- conflicts_tidy[conflicts_tidy$Party=="Republican" |
                                   conflicts_tidy$Party == "Democrat" |
                                   conflicts_tidy$Party == "Independent",]
conflicts_tidy <- conflicts_tidy[conflicts_tidy$Response == "Very strong conflicts"|
                                   conflicts_tidy$Response == "Strong conflicts"|
                                    conflicts_tidy$Response == "Not very strong conflicts"|
                                     conflicts_tidy$Response == "There are not conflicts",]
conflicts_summary <- conflicts_tidy %>%
  group_by(Party, Question, Response) %>%
  summarize(Freq = n()) %>%
  mutate(Prop = Freq/sum(Freq))
```
```{r plot conflicts}
likert_theme <- theme_gray() +
  theme(text = element_text(size = 10),
        plot.title = element_text(size = 11, face = "bold"), 
        plot.subtitle = element_text(face = "italic"),
        legend.title = element_blank(),
        legend.key.size = unit(.7, "line"),
        legend.background = element_rect(fill = "grey90"),
        axis.text.x = element_blank(),
        axis.ticks = element_blank(),
        axis.title = element_blank(),
        legend.position = "none",
        panel.grid = element_blank(),
        panel.background = element_rect(fill="grey98"),
        strip.background = element_blank(),
        strip.text.y = element_text(face = "bold",size=11),
        strip.text.x = element_text(size=10),
        panel.spacing.x = unit(0,"cm"),
        panel.spacing.y = unit(.7,"cm"))

ggplot(conflicts_summary, aes(Question, Prop, fill = fct_rev(Response))) +
  likert_theme + 
  geom_col() +
  geom_text(aes(Question, Prop, label = paste0(as.integer(100*Prop),"%")), # add percentage
            position = position_stack(vjust = .5),
            size = 2.7) +
  scale_fill_brewer(type = "seq", palette = "Oranges") + # use a diverging fill
  coord_flip() +
  guides(fill = guide_legend(reverse = TRUE)) +
  facet_grid(Party~Response) +
  ggtitle("\nA majority of Americans consider there are VERY STRONG conflicts between\nDemocrats and Republicans",
          subtitle = "Replies to the question: In your opinion, in AMERICA, are conflicts between ... very strong, strong, \nnot very strong, or there are not conflicts?\n\n")
```

From the graph above, we can immediately conclude that a majority of respondents, no matter what party they identified with, believe that there is at least some level of conflicts between each of the 5 opposing groups. Among all 5 groups, (Young, Old) and (People in cities, People in rural areas) are the 2 pairs with least perceived conflicts among all 5, with more than half of the respondents from each party selecting "not very strong conflicts" or "there are no conflicts". On the contrary,the conflicts between Democrats and Republicans are perceived as the most strong, with more than **70%** of respondents from each political party replying with "very strong conflicts". It's interesting to see that, both the actors of the conflict, Democrats and Republicans, and the bystanders, the political Independents, share the same opinion on this matter.

Differences among the 3 political groups:


1. Compared to the other 2 groups, Republicans, in general, perceive less strong conflicts between Poor and Rich.

2. Democrats perceive the conflicts between Black and White people to be a lot stronger than the other 2 groups do.

### *Other Controversial Social Topics*

```{r select party and q40, 41,42,45}
stopics <- politics[, c("party","q40","q42","q45")]
stopics <- stopics[!(stopics$party=="VOL) No preference"|
                       stopics$party=="(VOL) Other party"|
                       stopics$party=="(VOL) Don't know/Refused"|
                       stopics$q40=="(VOL) Don't know/Refused"|
                       stopics$q42=="(VOL) Don't know/Refused"|
                       stopics$q45=="(VOL) Don't know/Refused"),]
levels(stopics$q45)<- c("Strongly favor",
                        "Somewhat favor", 
                        "Somewhat oppose",
                        "Strongly oppose",
                        "(VOL) Don't know/Refused")

colnames(stopics) <- c("Party",
                       '"Medicare for all" replace private insurance',
                       "Free tuition at public colleges and universities to all American students",
                       "Death penalty for persons convicted of murder")

stopics_tidy <- pivot_longer(stopics,!Party,
                             names_to = "Question", 
                             values_to = "Response")
stopics_tidy$Party <- factor(stopics_tidy$Party,
                              levels= c("Democrat",
                              "Independent",
                              "Republican",
                              "VOL) No preference",
                              "(VOL) Other party"))
stopics_summary <- stopics_tidy %>%
  group_by(Party, Question, Response) %>%
  summarize(Freq = n()) %>%
  mutate(Prop = Freq/sum(Freq))
```

```{r plot stopics}
opposes <- stopics_summary[stopics_summary$Response=="Strongly oppose"|
                             stopics_summary$Response=="Somewhat oppose",]
supports <- stopics_summary[stopics_summary$Response=="Strongly favor"|
                             stopics_summary$Response=="Somewhat favor",]
ggplot() +
  theme_gray() +
  theme(text = element_text(size = 10),
        plot.title = element_text(size = 11, face = "bold"), 
        plot.subtitle = element_text(face = "italic"),
        legend.title = element_blank(),
        legend.key.size = unit(.7, "line"),
        axis.title = element_blank(),
        legend.position = "top",
        panel.grid = element_blank(),
        panel.background = element_rect(fill="grey98"),
        strip.background = element_blank(),
        strip.text.x = element_text(size=10, face = "italic"),
        panel.spacing.x = unit(0,"cm"),
        panel.spacing.y = unit(.7,"cm")) +
  geom_bar(data=supports, aes(x=Party, y=Prop, fill = Response),
           stat = "identity", position = "stack") +
  geom_bar(data=opposes, aes(x=Party, y=-Prop, fill = fct_rev(Response)),
           stat = "identity", position = "stack") +
  coord_flip() +
  scale_fill_manual(breaks = c("Strongly oppose", "Somewhat oppose", 
                                  "Somewhat favor", "Strongly favor"),
                    values = c("#CA0020", "#F4A582", "#92C5DE", "#0571B0"),
                    labels = c("Strongly oppose", "Somewhat oppose", 
                                  "Somewhat favor", "Strongly favor")) +
  facet_wrap(.~Question, nrow = 3) +
  xlab("") +
  scale_y_continuous(breaks = seq(-.8, .8, .2), labels = c("80%", "60%",
                                                           "40%","20%", "0%",
                                                          "20%", "40%", "60%",
                                                          "80%")) +
  ggtitle("\nDemocrats and Republicans show opposing views on topic about free tuition, Medicare, and death penalty",
          subtitle = "Replies to the question: Would you strongly favor, somewhat favor, somewhat oppose, or strongly oppose ... ?\n")
```
It's not surprising to see that a majority democrats and republicans disagree on all 3 topics, while independents are taking the middle ground. Democrats are more inclined to reduce death penalty, offer cheap resources for higher education, and replace expensive private insurance with the "Medicare for all" offered by the government, while republicans maintain the opposite views on all 3.

## Political Affliations, Socio-economic Status, Sex, Race, and Religious Beliefs
```{r select ISEX, IRACE1, EDUC, INCOME}
corr <- politics[,c("party","isex","iracem1","educ","income")]
colnames(corr) <- c("Party", "Sex", "Race", "Education", "Income")
gender <- corr %>%
  group_by(Party,Sex) %>%
  summarize(Freq = n()) %>%
  mutate(Prop = Freq/sum(Freq))

gender <- gender[!(gender$Party == "VOL) No preference"|
                   gender$Party == "(VOL) Other party"|
                   gender$Party == "(VOL) Don't know/Refused"),]
theme_bar <- theme_gray() +
  theme(text = element_text(size = 10),
        plot.title = element_text(size = 13, face = "bold",
                                  margin = margin(10, 0, 10, 0)), 
        plot.margin = unit(c(2,0,2,.4), "cm"),
        plot.title.position = "plot",
        axis.ticks = element_blank(),
        plot.subtitle = element_text(face = "italic"),
        legend.title = element_blank(),
        legend.key.size = unit(.7, "line"),
        axis.title = element_blank(),
        panel.grid = element_blank(),
        panel.background = element_blank(),
        strip.background = element_blank(),
        strip.text.x = element_text(size=10, face = "italic"),
        panel.spacing.x = unit(0,"cm"),
        panel.spacing.y = unit(.7,"cm"))
ggplot(gender) +
  theme_bar +
  theme(axis.text.x = element_blank(),
        legend.position = "top") +
  geom_bar(aes(Prop, Party, fill=fct_rev(Sex)),stat = "identity") +
  geom_text(aes(Prop, Party, label = paste0(as.integer(100*Prop),"%")), # add percentage
            position = position_stack(vjust = .5),
            size = 3, face = "bold")+
  scale_fill_brewer(type = "seq", palette = "Pastel1")+
  ggtitle("Sex doesn't seem to be a factor associated with party affliation",
          subtitle = "Proportion of Male and Female respondents identified with each of the three are very similar")
  
```


```{r race and party}
race <- corr %>%
  group_by(Party, Race) %>%
  summarize(Freq = n()) %>%
  mutate(Prop = Freq/sum(Freq))

race <- race[!(race$Party == "VOL) No preference"|
                   race$Party == "(VOL) Other party"|
                   race$Party == "(VOL) Don't know/Refused"),]
levels(race$Race) <- c("White",
                       "Black or African-American", 
                       "Asian or Asian-American",
                       "Some other race",
                       "Don't know/Refused")
ggplot(race) +
  theme_bar +
  theme(axis.text.x = element_blank(),
        legend.position = "none") +
  geom_bar(aes(Prop, Party, fill=fct_rev(Race)),stat = "identity") +
  geom_text(aes(Prop, Party, label = paste0(as.integer(100*Prop),"%")), # add percentage
            position = position_stack(vjust = .5),
            size = 3, face = "bold")+
  scale_fill_brewer(type = "seq", palette = "Pastel1") +
  facet_wrap(.~Race, nrow = 1)+
  guides(fill = guide_legend(reverse = TRUE)) +
  ggtitle("Race doesn't seem to be a significant factor associated with party affliation",
          subtitle = "Proportion of Black respondents identified as Republicans is slightly lower than that of the other two")
```

```{r chi-square test}
# run chi-square test
pvals <- lapply(corr[,-1], function(x) chisq.test(x, y =corr$Party)$p.value)
pvals[order(unlist(pvals))]
```

